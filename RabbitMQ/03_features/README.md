# TTL过期时间

> TTL表示可以对消息设置预期时间，这个时间内可以被消费者接收获取，过了之后将自动被删除。

RabbitMQ可以对消息和队列设置TTL，有两种方法可以设置

1. 通过队列属性设置，队列中所有消息都具有相同的过期时间
2. 对消息单独设置，每条消息的TTL可以不同

如果上述两种方法同时使用，则消息的过期时间以两者之间TTL较小的数值为准。

消息在队列的生存时间一旦超过TTL值，就会投递到死信队列(dmq)，消息者将无法再收到消息



# 死信队列

> DLX，全称Dead-Letter_Exchange，可以称之为死信交换机。当消息在一个队列中变成有毒消息后，它能被重新发送到另一个交换机中，这个交换机就是DLX，绑定DLX的队列就称之为死信队列

消息有毒可能是由于以下原因

* 消息被拒绝
* 消息过期
* 队列达到最大长度

DLX也是一个正常的交换机，和一般的交换机没有区别，它能在任何的队列上被指定，实际上就是设置某一个队列的属性。当这个队列中存在有毒消息时，RabbitMQ就会自动地将这个消息重新发布到设置DLX上，进而被路由到另一个队列，即为死信队列

想要使用死信队列，只需要在定义队列时设置队列参数`x-dead-letter-exchange`指定交换机即可